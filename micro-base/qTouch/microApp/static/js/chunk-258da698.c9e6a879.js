(window["webpackJsonpmicro_name_"]=window["webpackJsonpmicro_name_"]||[]).push([["chunk-258da698"],{"2d6c":function(e,t,a){"use strict";var i=a("f49a"),s=a.n(i);s.a},3055:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticClass:"container"},[e.visibleDialog?a("div",{staticClass:"main"},[a("q-left-right-layout",{staticStyle:{width:"100%"},attrs:{"left-title":"组织机构树","right-title":e.basicForm.name+"详情","btn-tip":"添加一级菜单"},on:{click:function(t){return e.editOrg("addTop",null)}}},[a("div",{attrs:{slot:"left"},slot:"left"},[a("el-input",{staticClass:"inpW",attrs:{placeholder:"输入关键字进行过滤",maxlength:100,size:"small"},model:{value:e.treeMessage.filterText,callback:function(t){e.$set(e.treeMessage,"filterText",t)},expression:"treeMessage.filterText"}}),a("div",{staticClass:"tree-body"},[a("el-tree",{ref:"orgTree",staticClass:"filter-tree",attrs:{data:e.treeMessage.data,props:e.defaultProps,"node-key":"id","default-expand-all":"","highlight-current":"","expand-on-click-node":!1,"filter-node-method":e.filterNode},on:{"node-click":e.orgNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,s=t.data;return a("div",{staticClass:"tree-node"},[a("span",{staticStyle:{display:"inline-block","text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap","word-break":"keep-all"},style:{width:200-18*(i.treeLevel-1)+"px"}},[e._v(e._s(i.label))]),a("span",[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-plus"},on:{click:function(t){return e.editOrg("add",s)}}}),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(t){return e.editOrg("edit",s)}}}),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.remove(s.id)}}})],1)])}}],null,!1,3091244643)})],1)],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.doLoading,expression:"doLoading"}],key:e.basicForm.id,staticClass:"submain-content",attrs:{slot:"right"},slot:"right"},[a("div",{staticClass:"content-title"},[a("i",{staticClass:"el-icon-menu"}),e._v("基础信息")]),a("div",{staticClass:"basic-attribute-body"},[a("el-form",{attrs:{"label-width":"100px",size:"mini","status-icon":"",model:e.basicForm}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"组织名称："}},[a("el-input",{staticStyle:{"max-width":"400px"},attrs:{id:"org-name",disabled:""},model:{value:e.basicForm.name,callback:function(t){e.$set(e.basicForm,"name",t)},expression:"basicForm.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"组织类型："}},[a("el-input",{staticStyle:{"max-width":"400px"},attrs:{disabled:""},model:{value:e.basicForm.typeName,callback:function(t){e.$set(e.basicForm,"typeName",t)},expression:"basicForm.typeName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"组织编码："}},[a("el-input",{staticStyle:{"max-width":"400px"},attrs:{disabled:""},model:{value:e.basicForm.code,callback:function(t){e.$set(e.basicForm,"code",t)},expression:"basicForm.code"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"单位状态："}},[a("el-input",{staticStyle:{"max-width":"400px"},attrs:{disabled:""},model:{value:e.basicForm.enterpriseFlag,callback:function(t){e.$set(e.basicForm,"enterpriseFlag",t)},expression:"basicForm.enterpriseFlag"}})],1)],1)],1)],1)],1),a("el-divider"),e.hasCustomRole?[a("div",{staticClass:"content-title"},[a("i",{staticClass:"el-icon-menu"}),e._v("自定义信息")]),a("q-custom-input",{ref:"custom-input",attrs:{customOptions:e.customOptions,disabled:!0}})]:e._e(),a("el-divider"),e._e()],2)])],1):a("add-org",{attrs:{type:e.type,id:e.currentId,parentId:e.parentId},on:{close:e.closeDialog}})],1)},s=[],r=(a("28a5"),a("96cf"),a("3b8d")),n=a("d225"),o=a("b0b4"),l=a("308d"),d=a("6bb5"),c=a("4e2b"),u=a("9ab4"),p=a("60a3"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"add-org"},[a("div",{staticClass:"title"},[e._v(e._s(e.dialogTitle))]),a("div",{staticClass:"basic-body"},[e._m(0),a("el-form",{ref:"addForm",attrs:{size:"small","label-width":"100px",model:e.addForm,rules:e.formRules}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"组织名称：",prop:"name"}},[a("el-input",{staticStyle:{"max-width":"500px"},attrs:{maxlength:100,placeholder:"请输入",clearable:""},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"组织类型：",prop:"typeDetailId"}},[a("q-tree",{attrs:{"tree-data":e.typeDetailOptions,"tree-prop":{value:"id",label:"name"},multi:!1,"need-stringify":!0,closable:!1},on:{qClick:e.changeCustomOptions},model:{value:e.addForm.typeDetailId,callback:function(t){e.$set(e.addForm,"typeDetailId",t)},expression:"addForm.typeDetailId"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"组织编码：",prop:"code"}},[a("el-input",{staticStyle:{"max-width":"500px"},attrs:{placeholder:"包含字母、数字、横线、下划线和点,点不能作为开头,长度3-100位",maxlength:100,clearable:""},model:{value:e.addForm.code,callback:function(t){e.$set(e.addForm,"code",t)},expression:"addForm.code"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"单位状态：",prop:"enterpriseFlag"}},[a("el-select",{staticStyle:{width:"100%","max-width":"400px"},model:{value:e.addForm.enterpriseFlag,callback:function(t){e.$set(e.addForm,"enterpriseFlag",t)},expression:"addForm.enterpriseFlag"}},e._l(e.enterOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1)],1)],1),e.hasCustomRole?a("div",{staticClass:"basic-body"},[e._m(1),a("q-custom-input",{ref:"customInput",attrs:{customOptions:e.customOptions}})],1):e._e(),a("div",{staticClass:"dialog-footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.closeDialog}},[e._v("返回")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveOrgInfo}},[e._v("确定")])],1)])},g=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-title"},[a("i",{staticClass:"el-icon-menu"}),e._v("基础信息")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-title"},[a("i",{staticClass:"el-icon-menu"}),e._v("自定义信息")])}],f=a("dcd8"),h=function(e){function t(){var e;return Object(n["a"])(this,t),e=Object(l["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.defaultProps={value:"id",label:"name",children:"children"},e.isLoading=!1,e.dialogTitle="",e.enterOptions=[{label:"否",value:0},{label:"是",value:1}],e.typeDetailOptions=[],e.orgVisible=!1,e.addForm={enterpriseFlag:0},e.formRules={name:[{required:!0,message:"该选项为必填项",trigger:"change"}],code:[{required:!0,message:"该选项为必填项",trigger:"change"}],typeDetailId:[{required:!0,message:"该选项为必填项",trigger:"blur"}]},e.hasCustomRole=qTouch.getBaseTypeByCode("organization"),e.customOptions=[],e.baseTypeList=[{id:""},{baseTypeName:""}],e}return Object(c["a"])(t,e),Object(o["a"])(t,[{key:"closeDialog",value:function(){this.$emit("close")}},{key:"getOrgInfo",value:function(e){var t=this;this.isLoading=!0,this.$http.get(f["a"].getOrgInfo+"/"+e).then((function(e){e.data.status?(t.addForm=e.data.data.orgInfo,t.customOptions=t.addForm.extInfoVO?t.addForm.extInfoVO:[]):t.$message.error(e.data.message)})).finally((function(){t.isLoading=!1}))}},{key:"getOrgType",value:function(){var e=this;this.orgVisible=!0,this.$http.get(f["a"].findTypeTree+"/organization").then((function(t){t.data.status?e.typeDetailOptions=t.data.data:e.$message.error(t.data.message)}))}},{key:"handleOrgChange",value:function(e,t){t&&this.$refs.orgTree.setCheckedKeys([e.id])}},{key:"saveOrg",value:function(){var e=this.$refs.orgTree.getCheckedKeys();e.length?this.addForm.typeDetailId=e[0]:this.addForm.typeDetailId="",this.orgVisible=!1,this.addForm.typeDetailId&&this.changeCustomOptions()}},{key:"getBaseTypeList",value:function(){var e=this;this.$http.get(f["a"].getBaseTypeList).then((function(t){t.status?e.baseTypeList=t.data.data:e.$message.error(t.data.message)}))}},{key:"changeCustomOptions",value:function(){var e=this;this.$http.get(f["a"].getTemplateByTypeDetaiId+"/"+this.addForm.typeDetailId).then((function(t){t.data.status?e.customOptions=t.data.data:e.$message.error(t.data.message)}))}},{key:"getFilledCustomOptions",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.$refs["customInput"],!t){e.next=5;break}return e.next=4,t.formValidation();case 4:return e.abrupt("return",e.sent);case 5:return e.abrupt("return",null);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"saveOrgInfo",value:function(){var e=this;this.$refs["addForm"].validate((function(t){t&&e.doSave()}))}},{key:"doSave",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t="edit"===this.type?f["a"].updateOrgBaseInfo:f["a"].addOrgBaseInfo,this.getFilledCustomOptions().then((function(e){a.isLoading=!0;var i=JSON.parse(JSON.stringify(Object.assign(a.addForm,{extInfo:e})));a.$http.post(t,i).then((function(e){e.data.status?(a.$message.success("操作成功"),a.addForm.id=e.data.data.id,a.closeDialog()):a.$message.error(e.data.message)})).finally((function(){a.isLoading=!1}))}));case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"created",value:function(){this.getBaseTypeList(),this.getOrgType(),"edit"===this.type?(this.dialogTitle="编辑组织机构",this.getOrgInfo(this.id)):(this.dialogTitle="添加组织机构","add"===this.type&&(this.addForm.parentId=this.parentId))}}]),t}(p["e"]);u["__decorate"]([Object(p["d"])({type:String,default:"add"})],h.prototype,"type",void 0),u["__decorate"]([Object(p["d"])({type:[String,Object],default:null})],h.prototype,"id",void 0),u["__decorate"]([Object(p["d"])({type:[String,Object],default:null})],h.prototype,"parentId",void 0),h=u["__decorate"]([Object(p["a"])({components:{}})],h);var b=h,y=b,v=(a("df89"),a("2877")),O=Object(v["a"])(y,m,g,!1,null,"d926e95c",null),F=O.exports,T=function(e){function t(){var e;return Object(n["a"])(this,t),e=Object(l["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.treeMessage={filterText:"",data:[]},e.defaultProps={value:"id",label:"name",children:"children"},e.basicForm={id:"",name:"",typeDetailId:"",enterpriseFlag:"",extInfoVO:[]},e.orgAccess=[],e.customOptions=[],e.baseTypeList=[{id:""},{baseTypeName:""}],e.parentId=null,e.currentId=null,e.type="",e.visibleDialog=!0,e.pageLoading=!0,e.doLoading=!0,e.hasCustomRole=qTouch.getBaseTypeByCode("organization"),e.testData="800d19c845d03b9315a6063d43597522",e}return Object(c["a"])(t,e),Object(o["a"])(t,[{key:"filterNode",value:function(e,t){return!e||-1!==t[this.defaultProps.label].indexOf(e)}},{key:"setFilterText",value:function(e){this.$refs.orgTree.filter(e)}},{key:"getTreeData",value:function(){var e=this;this.pageLoading=!0,this.$http.get(f["a"].getOrgTreeData).then((function(t){if(e.pageLoading=!1,t.data.status){e.treeMessage.data=t.data.data;var a=e.basicForm.id?e.basicForm.id:e.treeMessage.data[0]?e.treeMessage.data[0].id:"";a&&e.getOrgInfo(a),e.doLoading=!1}else e.$message.error(t.data.message)}))}},{key:"getOrgInfo",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,i,s,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.doLoading=!0,e.prev=1,e.next=4,this.$http.get(f["a"].getOrgInfo+"/"+t);case 4:a=e.sent,i=a.data,s=i.data,r=i.status,n=i.message,this.doLoading=!1,r?(this.basicForm=s.orgInfo,this.basicForm.typeDetailId=this.basicForm.typeDetailId.split(","),this.basicForm.enterpriseFlag=this.basicForm.enterpriseFlag?"是":"否",this.customOptions=this.basicForm.extInfoVO?this.basicForm.extInfoVO:[]):this.$message.error(n),e.next=17;break;case 13:return e.prev=13,e.t0=e["catch"](1),this.doLoading=!1,e.abrupt("return",this.$message.error("请求失败，请重试！"));case 17:case"end":return e.stop()}}),e,this,[[1,13]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setDisabled",value:function(e){for(var t in e)e[t].disabled=!0,e[t].children&&e[t].children.length&&this.setDisabled(e[t].children)}},{key:"getBaseTypeList",value:function(){var e=this;this.$http.get(f["a"].getBaseTypeList).then((function(t){t.data.status?e.baseTypeList=t.data.data:e.$message.error(t.data.message)}))}},{key:"orgNodeClick",value:function(e){this.getOrgInfo(e.id)}},{key:"editOrg",value:function(e,t){switch(this.type=e,e){case"addTop":this.parentId=null,this.currentId=null;break;case"add":this.currentId=null,this.parentId=t.id;break;case"edit":this.currentId=t.id;break}this.visibleDialog=!1}},{key:"remove",value:function(e){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$http.get(f["a"].delete+"/"+e).then((function(e){e.data.status?(t.$message.success(e.data.message),t.basicForm={id:"",name:""},t.getTreeData()):t.$message({showClose:!0,message:e.data.message,type:"error"})}))}))}},{key:"closeDialog",value:function(){this.visibleDialog=!0,this.customOptions=[],this.getTreeData()}},{key:"created",value:function(){this.getTreeData()}}]),t}(p["e"]);u["__decorate"]([Object(p["f"])("treeMessage.filterText")],T.prototype,"setFilterText",null),T=u["__decorate"]([Object(p["a"])({components:{AddOrg:F}})],T);var x=T,k=x,I=(a("2d6c"),Object(v["a"])(k,i,s,!1,null,"aa45e852",null));t["default"]=I.exports},dcd8:function(e,t,a){"use strict";var i={getBaseTypeList:"/admin/baseType/list",getTypeDetail:"/admin/typeDetail",findTypeTree:"/admin/typeDetail/findTypeTree",getTemplateByTypeDetaiId:"/admin/typeDetail/getTemplateByTypeDetaiId",getTreeData:"/admin/typeDetail/findTypeTree/organization",getAttrList:"/admin/typeDetail/attr/pagingAttr/organization",getTypeAndAttrs:"/admin/typeDetail/attr/transferData/organization",saveOrUpdateTypeAndAttrs:"/admin/typeDetail/saveOrUpdateTypeAndAttrs/organization",saveCustomAttrItems:"/admin/typeDetail/saveCustomAttrItems",deleteType:"/admin/typeDetail/delete",getOrgTreeData:"/admin/organization/orgTree",getOrgInfo:"/admin/organization/getOrgDetailById",addOrgBaseInfo:"/admin/organization/add",updateOrgBaseInfo:"/admin/organization/update",saveOrgAccess:"/admin/organization/saveOrgAccess",delete:"/admin/organization/delete",download:"/api/excel/download/orgTemplate",upload:"/api/excel/upload/orgTemplate"};t["a"]=i},df89:function(e,t,a){"use strict";var i=a("e121"),s=a.n(i);s.a},e121:function(e,t,a){},f49a:function(e,t,a){}}]);
//# sourceMappingURL=chunk-258da698.c9e6a879.js.map