(window["webpackJsonpmicro_name_"]=window["webpackJsonpmicro_name_"]||[]).push([["chunk-4d845dec"],{"69b8":function(e,t,a){},9879:function(e,t,a){"use strict";var i=a("69b8"),n=a.n(i);n.a},bd1f:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"main"},[a("aside",{staticClass:"aside"},[a("organization-info",{attrs:{pagination:e.pagination},on:{getList:e.getGridListByOrganization,detailsView:e.detailsView}})],1),a("section",{staticClass:"section"},[a("geographic-map",{ref:"geographic-map",attrs:{buttonName:e.buttonName},on:{openForm:e.openForm}})],1)]),e.dialogFormVisible?a("el-dialog",{attrs:{title:e.dialogFormVisibleName+"围栏",visible:e.dialogFormVisible,"before-close":e.handleCancel,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"fenceForm",attrs:{"label-width":"100px",size:"mini","status-icon":"",model:e.fenceForm,rules:e.gridFormRules}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"网格编码：",prop:"code"}},[a("el-input",{attrs:{disabled:e.disabled,placeholder:"包含字母、数字、横线、下划线和点,点不能作为开头,长度3-100位"},model:{value:e.fenceForm.code,callback:function(t){e.$set(e.fenceForm,"code",t)},expression:"fenceForm.code"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"网格名称：",prop:"name"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.fenceForm.name,callback:function(t){e.$set(e.fenceForm,"name",t)},expression:"fenceForm.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"行政区域：",prop:"regionCode"}},[a("el-cascader",{ref:"cascadeRegion",staticStyle:{width:"100%"},attrs:{disabled:e.disabled,options:e.regionOptions,props:e.regionProps},model:{value:e.fenceForm.regionCode,callback:function(t){e.$set(e.fenceForm,"regionCode",t)},expression:"fenceForm.regionCode"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"组织机构：",prop:"organizationName"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.fenceForm.organizationName,callback:function(t){e.$set(e.fenceForm,"organizationName",t)},expression:"fenceForm.organizationName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"网格面积：",prop:"area"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.fenceForm.area,callback:function(t){e.$set(e.fenceForm,"area",t)},expression:"fenceForm.area"}},[a("template",{slot:"append"},[e._v("\n                平方米\n              ")])],2)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"备注说明：",prop:"remark"}},[a("el-input",{attrs:{maxlength:255,type:"textarea",disabled:e.disabled,rows:8,resize:"none"},model:{value:e.fenceForm.remark,callback:function(t){e.$set(e.fenceForm,"remark",t)},expression:"fenceForm.remark"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"组织ID：",prop:"organizationId"}},[a("el-input",{model:{value:e.fenceForm.organizationId,callback:function(t){e.$set(e.fenceForm,"organizationId",t)},expression:"fenceForm.organizationId"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"坐标：",prop:"coordinates"}},[a("el-input",{model:{value:e.fenceForm.coordinates,callback:function(t){e.$set(e.fenceForm,"coordinates",t)},expression:"fenceForm.coordinates"}})],1)],1)],1)],1),e.disabled?e._e():a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleCancel()}}},[e._v("取 消")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.gridSave(e.dialogFormVisibleName)}}},[e._v("确 定")])],1)],1):e._e(),e.detailsVisible?a("el-dialog",{attrs:{title:"【"+e.detailsName+"】围栏列表详情",visible:e.detailsVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.detailsVisible=t}}},[e.fenceVisible?a("div",{staticStyle:{height:"100%"}},[a("el-input",{staticClass:"input-with-select",attrs:{size:"small",placeholder:"请输入内容",clearable:""},on:{input:function(t){return e.getGridListByOrganization(e.organizationInfo)}},model:{value:e.pagination.condition,callback:function(t){e.$set(e.pagination,"condition",t)},expression:"pagination.condition"}}),a("div",{staticClass:"loading-area",staticStyle:{height:"calc(100% - 60px)"}},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.pagination.tableData,stripe:"",size:"mini","tooltip-effect":"dark","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"序号",type:"index",width:"100"}}),a("el-table-column",{attrs:{align:"center",prop:"code",label:"编号","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",prop:"name",label:"名称","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",prop:"region",label:"区域","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",prop:"area",label:"面积(m²)","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",prop:"remark",label:"备注","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",prop:"bind",label:"绑定","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.openPersonList(t.row)}}},[e._v("绑定人员")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.openVehicleList(t.row)}}},[e._v("绑定车辆")])]}}],null,!1,3275219483)})],1)],1),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.pagination.currentPage,small:"","page-size":e.pagination.pageSize,layout:"total, prev, pager, next, jumper",total:e.pagination.total},on:{"current-change":function(t){return e.getGridListByOrganization(e.organizationInfo)},"update:currentPage":function(t){return e.$set(e.pagination,"currentPage",t)},"update:current-page":function(t){return e.$set(e.pagination,"currentPage",t)}}})],1)],1):e._e(),e.personBindVisible?a("div",{staticStyle:{height:"100%"}},[a("el-row",{staticClass:"filter",staticStyle:{padding:"0 0 20px 0"},attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{size:"small",placeholder:"姓名",clearable:""},on:{clear:e.getPersonList},model:{value:e.personPagination.query.name,callback:function(t){e.$set(e.personPagination.query,"name",t)},expression:"personPagination.query.name"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getPersonList},slot:"append"})],1)],1),a("el-col",{attrs:{span:18}},[a("div",{staticClass:"button-group"},[a("el-button",{staticStyle:{float:"left"},attrs:{size:"small"},on:{click:e.multiplePersonBind}},[e._v("绑定 ")]),a("el-button",{staticStyle:{float:"right"},attrs:{size:"small"},on:{click:e.backToFence}},[e._v("返回 ")])],1)])],1),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.personTableData,stripe:"","header-row-style":{height:"60px"},height:"calc(100vh - 220px)",size:"mini","tooltip-effect":"dark"},on:{"selection-change":e.getAllSelected}},[a("el-table-column",{attrs:{align:"center",prop:"id",label:"序号",type:"index",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.$index+(e.personPagination.current-1)*e.personPagination.size+1)+" ")])]}}],null,!1,3397697017)}),a("el-table-column",{attrs:{align:"center",type:"selection","min-width":"60"}}),a("el-table-column",{attrs:{align:"center",prop:"username",label:"用户名","min-width":"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",prop:"realName",label:"姓名","min-width":"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",prop:"mobile",label:"手机","min-width":"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",prop:"typeName",label:"人员类型","min-width":"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete",title:"解除绑定"},on:{click:function(a){return e.handleDelete(t.row)}}})]}}],null,!1,1466549836)})],1),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.personPagination.current,small:"",background:"","page-size":e.personPagination.pageSize,layout:"total, prev, pager, next, jumper",total:e.personPagination.total},on:{"current-change":e.getPersonList,"update:currentPage":function(t){return e.$set(e.personPagination,"current",t)},"update:current-page":function(t){return e.$set(e.personPagination,"current",t)}}})],1)],1):e._e(),e.vehicleBindVisible?a("div",{staticStyle:{height:"100%"}},[a("el-row",{staticClass:"filter",staticStyle:{padding:"0 0 20px 0"},attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{size:"small",placeholder:"编码",clearable:""},on:{clear:e.getVehicleList},model:{value:e.vehiclePagination.query.code,callback:function(t){e.$set(e.vehiclePagination.query,"code",t)},expression:"vehiclePagination.query.code"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getPersonList},slot:"append"})],1)],1),a("el-col",{attrs:{span:18}},[a("div",{staticClass:"button-group"},[a("el-button",{staticStyle:{float:"left"},attrs:{size:"small"},on:{click:e.multipleVeguckeBind}},[e._v("绑定 ")]),a("el-button",{staticStyle:{float:"right"},attrs:{size:"small"},on:{click:e.backToFence}},[e._v("返回 ")])],1)])],1),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.vehiclePagination.tableData,stripe:"","header-row-style":{height:"60px"},size:"mini","tooltip-effect":"dark"},on:{"selection-change":e.getAllSelected}},[a("el-table-column",{attrs:{align:"center",label:"序号",type:"index",width:"100"}}),a("el-table-column",{attrs:{align:"center",type:"selection","min-width":"60"}}),a("el-table-column",{attrs:{align:"center",prop:"code",label:"车辆编号","min-width":"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",prop:"licensePlate",label:"车牌号","min-width":"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",prop:"typeDetailName",label:"车辆类型","min-width":"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",prop:"orgName",label:"所属组织","min-width":"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",prop:"isStarted",label:"是否启用","min-width":"","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.isStarted?a("span",{staticStyle:{"font-size":"12px"}},[e._v("否")]):a("span",{staticStyle:{"font-size":"12px"}},[e._v("是")])]}}],null,!1,496268323)}),a("el-table-column",{attrs:{align:"center",prop:"remark",label:"备注","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",label:"绑定",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete",title:"删除"},on:{click:function(a){return e.handleDelete(t.row)}}})]}}],null,!1,3635479108)})],1),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.vehiclePagination.current,small:"",background:"","page-size":e.vehiclePagination.size,layout:"total, prev, pager, next, jumper",total:e.vehiclePagination.total},on:{"current-change":e.getVehicleList,"update:currentPage":function(t){return e.$set(e.vehiclePagination,"current",t)},"update:current-page":function(t){return e.$set(e.vehiclePagination,"current",t)}}})],1)],1):e._e()]):e._e()],1)},n=[],o=(a("ac6a"),a("7f7f"),a("6b54"),a("28a5"),a("d225")),l=a("b0b4"),r=a("308d"),s=a("6bb5"),c=a("4e2b"),d=a("9ab4"),p=a("60a3"),u=a("fc0d"),g=a("a0b5"),m=a("dc7d"),f=a("73ec"),h=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(r["a"])(this,Object(s["a"])(t).apply(this,arguments)),e.multipleSelection=[],e.pagination={condition:"",currentPage:1,total:0,tableData:[],pageSize:10},e.fenceId="",e.personPagination={current:1,size:15,total:0,query:{name:"",typeId:"",organizationId:"",mobile:"",tel:""}},e.vehiclePagination={query:{},tableData:[],current:1,page:15,total:0},e.buttonName="绘制电子围栏",e.organizationInfo=null,e.fenceForm={id:"",code:"",name:"",regionCode:[],area:"",coordinates:"",remark:"",organizationId:"",organizationName:""},e.gridFormRules={code:[{required:!0,message:"请输入网格编码",trigger:"change"}],name:[{required:!0,message:"请输入网格名称",trigger:"change"}],regionCode:[{required:!0,message:"请选择区域",trigger:"change"}]},e.regionOptions=[],e.regionProps={value:"code",label:"name"},e.disabled=!1,e.dialogFormVisible=!1,e.dialogFormVisibleName="",e.detailsVisible=!1,e.detailsName="",e.fenceVisible=!0,e.personBindVisible=!1,e.personTableData=[],e.vehicleBindVisible=!1,e}return Object(c["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){this.getRegions(),this.getPersonList(),this.getVehicleList()}},{key:"getGridListByOrganization",value:function(e){var t=this;this.organizationInfo=e,this.$http.post(m["a"].fence.getElectricFenceByOrganizationId,{query:{name:this.pagination.condition.split(" ").join(""),organizationId:e.id},size:this.pagination.pageSize,current:this.pagination.currentPage}).then((function(e){e.data.status?(t.pagination.tableData=e.data.data.records,t.pagination.total=e.data.data.total,t.pagination.currentPage=e.data.data.current):t.$message.error(e.data.message)})),this.$http.post(m["a"].fence.getElectricFenceByOrganizationId,{query:{name:this.pagination.condition.split(" ").join(""),organizationId:e.id},size:9999,current:1}).then((function(e){e.data.status?t.$refs["geographic-map"].polygonShow(e.data.data.records):t.$message.error(e.data.message)}))}},{key:"getRegions",value:function(){var e=this;this.$http.get(m["a"].organization.getRegions).then((function(t){t.data.status?(e.regionOptions=t.data.data,f["a"].removeEmptyChildren(e.regionOptions)):e.$message.error(t.data.message)}))}},{key:"gridSave",value:function(e){var t=this,a="添加"===e?m["a"].fence.fenceAdd:m["a"].fence.fenceUpdate,i=JSON.parse(JSON.stringify(this.fenceForm));i.regionCode=i.regionCode.toString(),i.region=this.$refs["cascadeRegion"].inputValue,this.$refs["fenceForm"].validate((function(e){if(!e)return console.log("信息有误"),!1;t.$http.post(a,i).then((function(e){e.data.status?(t.$message.success(e.data.message),t.getGridListByOrganization(t.organizationInfo)):t.$message.error(e.data.message),t.dialogFormVisible=!1})).catch((function(e){console.log(e),t.$message.error(e.data.message),t.dialogFormVisible=!1}))}))}},{key:"openForm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;"添加"===t?(this.fenceForm.id="",this.fenceForm.code="",this.fenceForm.name="",this.fenceForm.regionCode=[],this.fenceForm.area=e.gridArea,this.fenceForm.coordinates=e.coordinates,this.fenceForm.remark=""):(this.fenceForm.id=e.id,this.fenceForm.code=e.code,this.fenceForm.name=e.name,this.fenceForm.regionCode=e.regionCode.split(","),this.fenceForm.area=e.area,this.fenceForm.coordinates=e.coordinates,this.fenceForm.remark=e.remark),this.disabled="查看"===t,this.fenceForm.organizationId=this.organizationInfo.id,this.fenceForm.organizationName=this.organizationInfo.name,this.dialogFormVisible=!0,this.dialogFormVisibleName=t}},{key:"detailsView",value:function(e){var t=this;this.detailsName=e.name,this.$nextTick((function(){t.detailsVisible=!0,t.fenceVisible=!0,t.personBindVisible=!1,t.vehicleBindVisible=!1}))}},{key:"handleCancel",value:function(){this.dialogFormVisible=!1}},{key:"openPersonList",value:function(e){this.fenceVisible=!1,this.personBindVisible=!0,this.fenceId=e.id}},{key:"getPersonList",value:function(){var e=this;this.$http.post(m["a"].person.getPaging,this.personPagination).then((function(t){t.status&&(t.data.status?(e.personTableData=t.data.data.records,e.personPagination.total=t.data.data.total):e.$message.error(t.data.message))}))}},{key:"getAllSelected",value:function(e){this.multipleSelection=e}},{key:"bindingPerson",value:function(e){var t=this;this.$http.post("".concat(m["a"].fence.bindPerson).concat(this.fenceId),e).then((function(e){e.data.status?(console.log("1123"),t.$message({type:"success",message:"绑定成功!"})):t.$message({showClose:!0,message:e.data.message,type:"error"})}))}},{key:"multiplePersonBind",value:function(){var e=[];this.multipleSelection.forEach((function(t){e.push(t.id)})),this.bindingPerson(e)}},{key:"backToFence",value:function(){this.fenceVisible=!0,this.vehicleBindVisible=!1,this.personBindVisible=!1}},{key:"openVehicleList",value:function(e){this.fenceVisible=!1,this.vehicleBindVisible=!0,this.fenceId=e.id}},{key:"getVehicleList",value:function(){var e=this;this.$http.post(m["a"].car.getPaging,this.vehiclePagination).then((function(t){t.data.status?(e.vehiclePagination.tableData=t.data.data.records,e.vehiclePagination.total=t.data.data.total):e.$message.error(t.data.message)}))}},{key:"multipleVeguckeBind",value:function(){var e=[];this.multipleSelection.forEach((function(t){e.push(t.id)})),this.bindingVehicle(e)}},{key:"bindingVehicle",value:function(e){var t=this;this.$http.post("".concat(m["a"].fence.bindCar).concat(this.fenceId),e).then((function(e){e.data.status?t.$message({type:"success",message:"绑定成功!"}):t.$message({showClose:!0,message:e.data.message,type:"error"})}))}}]),t}(p["e"]);h=d["__decorate"]([Object(p["a"])({components:{GeographicMap:g["a"],OrganizationInfo:u["a"]}})],h);var b=h,v=b,w=(a("9879"),a("2877")),y=Object(w["a"])(v,i,n,!1,null,"1b1dca80",null);t["default"]=y.exports}}]);
//# sourceMappingURL=chunk-4d845dec.2c552a98.js.map